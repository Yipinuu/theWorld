<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="description" content="是游悠品意的个人站点，现在主要是技术文章和个人作品发表"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="alternative" href="/atom.xml" title="照东方万八千世界" type="application/atom+xml"><link rel="icon" href="/favicon.png"><title>从头开始，部署 Ruby 环境！ - 照东方万八千世界</title><link rel="stylesheet" href="/css/main.css" type="text/css"><!--[if lt IE 9]><script>(function(a,b){a="abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video".split(" ");for(b=a.length-1;b>=0;b--)document.createElement(a[b])})()</script><![endif]--></head><body><header class="head"><h1 class="head-title u-fl"><a href="/">照东方万八千世界</a></h1><nav class="head-nav u-fr"><ul class="head-nav__list"><li class="head-nav__item"><a href="/" class="head-nav__link">Home</a></li><li class="head-nav__item"><a href="/archives" class="head-nav__link">Archives</a></li><li class="head-nav__item"><a href="http://Lofter.yipinuu.com" class="head-nav__link">Photo</a></li><li class="head-nav__item"><a href="/about.html" class="head-nav__link">About</a></li></ul></nav></header><main class="main"><article class="post"><header class="post__head"><time datetime="2015-11-04T16:00:00.000Z" class="post__time">十一月 5, 2015</time><h1 class="post__title"><a href="/2015/deploy-ruby-production/">从头开始，部署 Ruby 环境！</a></h1></header><div class="post__main echo"><h2 id="前言">前言</h2><p>当我们新买好一个服务器时，要经历过哪些大山才能成功部署好 Ruby 的“生存环境”呢？</p>
<h2 id="步骤">步骤</h2><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">apt-<span class="built_in">get</span> -<span class="keyword">y</span> <span class="keyword">update</span></span><br><span class="line">apt-<span class="built_in">get</span> -<span class="keyword">y</span> install curl git-core <span class="keyword">python</span>-software-properties</span><br></pre></td></tr></table></figure>
<h3 id="nginx">nginx</h3><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">add</span>-apt-repository <span class="keyword">pp</span><span class="variable">a:nginx</span>/stable</span><br><span class="line">apt-<span class="built_in">get</span> -<span class="keyword">y</span> <span class="keyword">update</span></span><br><span class="line">apt-<span class="built_in">get</span> -<span class="keyword">y</span> install nginx</span><br><span class="line">service nginx start</span><br></pre></td></tr></table></figure>
<h3 id="PostgreSQL">PostgreSQL</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">add-apt-repository ppa:pitti/postgresql</span><br><span class="line">apt-get -y <span class="operator"><span class="keyword">update</span></span><br><span class="line">apt-<span class="keyword">get</span> -y <span class="keyword">install</span> postgresql libpq-dev</span><br><span class="line">sudo -u postgres psql</span><br><span class="line"># \<span class="keyword">password</span></span><br><span class="line"># <span class="keyword">create</span> <span class="keyword">user</span> blog <span class="keyword">with</span> <span class="keyword">password</span> <span class="string">'secret'</span>;</span></span><br><span class="line"># <span class="operator"><span class="keyword">create</span> <span class="keyword">database</span> blog_production owner blog;</span></span><br><span class="line"># \q</span><br></pre></td></tr></table></figure>
<h3 id="Mysql">Mysql</h3><figure class="highlight axapta"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install mysql-<span class="keyword">server</span> mysql-<span class="keyword">common</span> mysql-<span class="keyword">client</span> libmysqlclient-dev</span><br></pre></td></tr></table></figure>
<h3 id="Postfix">Postfix</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-<span class="keyword">get</span> -y install telnet <span class="keyword">postfix</span></span><br></pre></td></tr></table></figure>
<h3 id="Node-js">Node.js</h3><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">add</span>-apt-repository <span class="keyword">pp</span><span class="variable">a:chris</span>-lea/node.js</span><br><span class="line">apt-<span class="built_in">get</span> -<span class="keyword">y</span> <span class="keyword">update</span></span><br><span class="line">apt-<span class="built_in">get</span> -<span class="keyword">y</span> install nodejs</span><br></pre></td></tr></table></figure>
<h3 id="Add_deployer_user">Add deployer user</h3><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">adduser deployer --ingroup sudo</span><br><span class="line"><span class="keyword">su</span> deployer</span><br><span class="line"><span class="keyword">cd</span></span><br></pre></td></tr></table></figure>
<h3 id="Ruby_with_rbenv">Ruby with rbenv</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">curl https:<span class="comment">//raw.githubusercontent.com/fesplugas/rbenv-installer/master/bin/rbenv-installer | bash</span></span><br><span class="line">vim <span class="class">.bashrc</span> <span class="hexcolor">#add</span> rbenv to the <span class="attribute">top</span></span><br><span class="line">. <span class="class">.bashrc</span></span><br><span class="line">sudo apt-get install build-essential libssl-dev libpcre3-dev libncurses5-dev libreadline6-dev libreadline-dev</span><br><span class="line">rbenv install <span class="number">2.0</span>.<span class="number">0</span>-p643</span><br><span class="line">rbenv global <span class="number">2.0</span>.<span class="number">0</span>-p643</span><br><span class="line">gem install bundler --no-ri --no-rdoc</span><br><span class="line">rbenv rehash</span><br></pre></td></tr></table></figure>
<h3 id="Get_to_know_git">Get to know git</h3><p>ssh-keygen -C “your-email-address”<br>cat .ssh/id_rsa.pub<br>ssh git@github.com<br>ssh git@git.coding.net</p>
<h2 id="最后">最后</h2><p>现在服务器已经可以安装好Ruby的环境了。接下来我们会利用 Cap 对 App 进行自动化部署。</p>
</div><footer class="post__foot u-cf"><a href="/2015/deploy-ruby-production/#disqus_thread" class="post__foot-link u-fr">0 COMMENTS</a></footer></article><div class="comments"><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript></div></div></main><footer class="foot"><div class="foot-copy u-fl">&copy; 2015 游悠品意</div><menu class="page-menu u-fr"><li class="page-menu__item"><a title="Previous" href="/2015/RubyGems-capistrano-Practice-notes/" class="page-menu__link icon-arrow-left"></a></li><li class="page-menu__item"><a title="Next" href="/2015/Rails-check-box-tag/" class="page-menu__link icon-arrow-right"></a></li></menu></footer><script>(function(h,g,l,k,j,i){j=h.createElement(g),i=h.getElementsByTagName(g)[0],
j.src="//"+l+".disqus.com/"+k+".js",i.parentNode.insertBefore(j,i)})
(document,"script","yipinuu","embed");
</script></body></html>